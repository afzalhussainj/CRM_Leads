{% if column_key == 'title' %}
  {{ lead.title|default:"—" }}
{% elif column_key == 'linkedin' %}
  {% if lead.contact_linkedin_url %}<a class="btn ghost" href="{{ lead.contact_linkedin_url }}" target="_blank">Open</a>{% else %}<span class="muted">—</span>{% endif %}
{% elif column_key == 'status' %}
  <select class="status-dropdown" onchange="updateLeadStatus('{{ lead.pk }}', this.value)">
    {% for value, label in lead_status_choices %}
      {% if request.user.profile.role|add:"0" == UserRole.DEV_LEAD and value != 'closed' %}
        <!-- Development leads can only set status to 'closed' -->
      {% else %}
        <option value="{{ value }}" {% if lead.status.name == value %}selected{% endif %}>{{ label }}</option>
      {% endif %}
    {% endfor %}
  </select>
{% elif column_key == 'assigned_to' %}
  {% if request.user.profile.role|add:"0" == ROLE_MANAGER_VALUE or request.user.profile.role|add:"0" == ROLE_EMPLOYEE_VALUE %}
    <select class="status-dropdown" onchange="updateAssignedTo('{{ lead.pk }}', this.value)">
      <option value="">Unassigned</option>
      <option value="{{ user_profile.id }}" {% if lead.assigned_to == user_profile %}selected{% endif %}>{{ user_profile.user.first_name|default:user_profile.user.email }} (Me)</option>
      {% for profile in available_profiles %}
        <option value="{{ profile.id }}" {% if lead.assigned_to == profile %}selected{% endif %}>{{ profile.user.first_name|default:profile.user.email }}</option>
      {% endfor %}
    </select>
  {% else %}
    {% if lead.assigned_to %}{{ lead.assigned_to.user.first_name|default:lead.assigned_to.user.email }}{% else %}<span class="muted">—</span>{% endif %}
  {% endif %}
{% elif column_key == 'follow_up_at' %}
  {% if lead.follow_up_at %}
    {{ lead.follow_up_at|date:"M d, Y, g:i A" }}
  {% else %}
    <span class="muted">—</span>
  {% endif %}
{% elif column_key == 'follow_up_status' %}
  <form method="post" class="inline-status-form" data-lead="{{ lead.pk }}" style="display:inline-block;">
    {% csrf_token %}
    <select name="status" id="status-select-{{ lead.pk }}" class="status-dropdown" onchange="updateFollowUpStatus('{{ lead.pk }}', this.value)">
      <option value="pending" {% if lead.follow_up_status == 'pending' %}selected{% endif %}>Pending</option>
      <option value="done" {% if lead.follow_up_status == 'done' %}selected{% endif %}>Done</option>
    </select>
  </form>
{% elif column_key == 'company_name' %}
  {{ lead.company_name|default:"—" }}
{% elif column_key == 'contact_name' %}
  {% if lead.contact_first_name or lead.contact_last_name %}
    {{ lead.contact_first_name }} {{ lead.contact_last_name }}
  {% else %}
    <span class="muted">—</span>
  {% endif %}
{% elif column_key == 'contact_email' %}
  {% if lead.contact_email %}<a href="mailto:{{ lead.contact_email }}">{{ lead.contact_email }}</a>{% else %}<span class="muted">—</span>{% endif %}
{% elif column_key == 'contact_phone' %}
  {% if lead.contact_phone %}{{ lead.contact_phone }}{% else %}<span class="muted">—</span>{% endif %}
{% elif column_key == 'source' %}
  {{ lead.source|default:"—" }}
{% elif column_key == 'description' %}
  {% if lead.description %}{{ lead.description|truncatechars:50 }}{% else %}<span class="muted">—</span>{% endif %}
{% elif column_key == 'created_at' %}
  {{ lead.created_at|date:"M d, Y" }}
{% elif column_key == 'always_active' %}
  {% if request.user.profile.role|add:"0" == ROLE_MANAGER_VALUE %}
    <button class="btn small {% if lead.always_active %}primary{% else %}ghost{% endif %}" 
            onclick="toggleAlwaysActive('{{ lead.pk }}')" 
            title="{% if lead.always_active %}Remove from Always Active{% else %}Add to Always Active{% endif %}">
      {% if lead.always_active %}
        On
      {% else %}
        Off
      {% endif %}
    </button>
  {% else %}
    {% if lead.always_active %}
      <span class="status-chip always-active">Always Active</span>
    {% else %}
      <span class="muted">—</span>
    {% endif %}
  {% endif %}
{% elif column_key == 'priority' %}
  {% if request.user.profile.role|add:"0" == ROLE_MANAGER_VALUE %}
    <button class="btn small {% if lead.priority %}primary{% else %}ghost{% endif %}" 
            onclick="togglePriority('{{ lead.pk }}')" 
            title="{% if lead.priority %}Remove from Priority{% else %}Add to Priority{% endif %}">
      {% if lead.priority %}
        On
      {% else %}
        Off
      {% endif %}
    </button>
  {% else %}
    {% if lead.priority %}
      <span class="status-chip priority">High Priority</span>
    {% else %}
      <span class="muted">Normal</span>
    {% endif %}
  {% endif %}
{% endif %}